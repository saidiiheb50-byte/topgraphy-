const i18n = {
  fr: {
    nav: { services: 'Services', projects: 'Projets', gallery: 'Galerie', tech: 'Tech & Équipements', contact: 'Contact' },
    hero: {
      badge: 'Précision · Cartographie · 3D',
      title: 'BETLAB · Ingénieur topographe spécialisé en levés, cartographie et modèles 3D.',
      lead: "Je livre des plans exploitables, orthophotos, DEM/DTM et analyses géospatiales pour vos projets d'infrastructure et d'immobilier.",
      meta1: 'Réponse sous 24h',
      meta2: 'Certifié / agréé',
      meta3: 'Couverture nationale',
      mapTitle: 'Carte drone + MNT',
      mapNote: 'Exemple de relevé présenté via Leaflet.'
    },
    cta: { quote: 'Demander un devis', projects: 'Voir mes projets' },
    services: {
      badge: 'Compétences',
      title: 'Services principaux',
      desc: 'Des levés fiables pour routes, bâtiments, aménagements et énergie.',
      s1: { title: 'Levés topographiques', text: 'Construction, routes, immobilier. Précision centimétrique.' },
      s2: { title: 'Photogrammétrie drone', text: 'Orthophotos, modèles 3D, inspections visuelles rapides.' },
      s3: { title: 'Modèles 3D & DEM/DTM', text: 'Calculs de volumes, pentes, terrassements et cubatures.' },
      s4: { title: 'Bornage & limites', text: 'Délimitation de propriétés, plans de bornage conformes.' },
      s5: { title: 'Hydrographie', text: 'Levés bathymétriques pour ports, retenues et ouvrages.' },
      s6: { title: 'Plans & digitalisation', text: 'Création CAD, mise à jour de plans, cartographie précise.' }
    },
    projects: {
      badge: 'Réalisations',
      title: 'Projets clés',
      desc: 'Études de cas avec méthodes, livrables et gains mesurables.',
      before: 'Avant',
      after: 'Après',
      c1: {
        title: 'Route express - Modèle 3D',
        li1: 'Méthode : GNSS RTK + drone',
        li2: 'Livrables : Orthophoto, DEM, CAD',
        li3: 'Gain : précision 2 cm, délai -30%'
      },
      c2: {
        title: 'Lotissement - Plan topo',
        li1: 'Méthode : Station totale',
        li2: 'Livrables : Plan DWG + courbes',
        li3: 'Gain : zéro reprise terrain',
        badge: 'CAD prêt BIM'
      }
    },
    gallery: {
      badge: 'Galerie terrain',
      title: 'Images de projets topographiques',
      desc: 'Terrain, drone, reliefs et livrables visuels pour BETLAB.',
      g1: { title: 'Orthophoto drone', text: 'Chantier urbain cartographié en haute résolution.' },
      g2: { title: 'Relief & courbes', text: 'Modèle 3D avec courbes de niveau pour terrassement.' },
      g3: { title: 'Station totale', text: 'Implantations et levés détaillés en chantier.' },
      g4: { title: 'Inspection drone', text: 'Survol rapide pour volumes et contrôles visuels.' }
    },
    tech: {
      badge: 'Capacités',
      title: 'Technologies & Équipements',
      desc: 'Matériel de précision et logiciels métier pour des livrables fiables.',
      e1: { title: 'Station totale', text: 'Implantations, levés détaillés, alignements précis.' },
      e2: { title: 'GPS/GNSS RTK', text: 'Précision centimétrique en temps réel sur grands linéaires.' },
      e3: { title: 'Drones', text: 'Orthophotos haute résolution, volumes, inspections rapides.' },
      e4: { title: 'Logiciels', text: 'AutoCAD, Civil 3D, QGIS/ArcGIS, Pix4D, Revit, CloudCompare.' }
    },
    contact: {
      badge: 'Contact',
      title: 'Demander un devis',
      desc: 'Ajoutez vos plans ou précisez la surface, je réponds sous 24h.',
      whatsapp: 'WhatsApp direct'
    },
    form: {
      name: 'Nom / Entreprise',
      email: 'Email',
      phone: 'Téléphone / WhatsApp',
      project: 'Type de projet',
      details: 'Détails / surface / délai'
    },
    footer: {
      text: 'Topographie de précision, livrables exploitables, réponse rapide.',
      links: 'Liens',
      contact: 'Contact'
    }
  },
  ar: {
    nav: { services: 'الخدمات', projects: 'المشاريع', gallery: 'المعرض', tech: 'التقنيات والمعدات', contact: 'اتصال' },
    hero: {
      badge: 'دقة · خرائط · ثلاثي الأبعاد',
      title: 'BETLAB · مهندس طبوغرافيا متخصص في الرفع المساحي والخرائط والنمذجة ثلاثية الأبعاد.',
      lead: 'أوفر مخططات جاهزة للاستخدام، صوراً مصححة، نماذج ارتفاع رقمية وتحليلات مكانية لمشاريع البنية التحتية والعقارات.',
      meta1: 'رد خلال 24 ساعة',
      meta2: 'معتمد / مرخّص',
      meta3: 'تغطية وطنية',
      mapTitle: 'خريطة درون + نموذج ارتفاع',
      mapNote: 'مثال رفع مبيّن عبر Leaflet.'
    },
    cta: { quote: 'اطلب عرض سعر', projects: 'عرض المشاريع' },
    services: {
      badge: 'الكفاءات',
      title: 'الخدمات الرئيسية',
      desc: 'رفع دقيق للطرق والمباني والمشاريع العمرانية والطاقة.',
      s1: { title: 'الرفع الطوبوغرافي', text: 'إنشاءات، طرق، عقار. دقة بالسنتيمتر.' },
      s2: { title: 'التصوير الجوي بالدرون', text: 'صور مصححة ونماذج ثلاثية الأبعاد وفحص بصري سريع.' },
      s3: { title: 'نماذج ثلاثية الأبعاد و DEM/DTM', text: 'حساب أحجام وميل وتسويات وحفريات.' },
      s4: { title: 'تحديد الحدود', text: 'تحديد الملكيات ومخططات التحديد وفق المتطلبات.' },
      s5: { title: 'مسح هيدروغرافي', text: 'رفع أعماق للموانئ والخزانات والمنشآت.' },
      s6: { title: 'مخططات ورقمنة', text: 'إنشاء ملفات CAD وتحديث المخططات ورسم خرائط دقيق.' }
    },
    projects: {
      badge: 'الإنجازات',
      title: 'مشاريع أساسية',
      desc: 'دراسات حالة مع المنهجية والمخرجات والفوائد.',
      before: 'قبل',
      after: 'بعد',
      c1: {
        title: 'طريق سريع - نموذج ثلاثي الأبعاد',
        li1: 'المنهجية: GNSS RTK + درون',
        li2: 'المخرجات: صورة مصححة، DEM، CAD',
        li3: 'الفائدة: دقة 2 سم، زمن أقل بـ 30%'
      },
      c2: {
        title: 'تجزئة سكنية - رفع طبوغرافي',
        li1: 'المنهجية: محطة شاملة',
        li2: 'المخرجات: ملف DWG + خطوط كنتور',
        li3: 'الفائدة: دون إعادة عمل ميداني',
        badge: 'CAD جاهز لـ BIM'
      }
    },
    gallery: {
      badge: 'المعرض الميداني',
      title: 'صور مشاريع طبوغرافية',
      desc: 'ميدان، درون، تضاريس ومخرجات بصرية لـ BETLAB.',
      g1: { title: 'صورة مصححة بالدرون', text: 'موقع حضري مصوَّر بدقة عالية.' },
      g2: { title: 'تضاريس وخطوط كنتور', text: 'نموذج ثلاثي الأبعاد مع خطوط مستوى للأشغال.' },
      g3: { title: 'محطة شاملة', text: 'توقيع وتمركز ورفع تفصيلي في الموقع.' },
      g4: { title: 'تفتيش بالدرون', text: 'تحليق سريع للأحجام والفحص البصري.' }
    },
    tech: {
      badge: 'القدرات',
      title: 'التقنيات والمعدات',
      desc: 'معدات دقيقة وبرمجيات متخصصة لمخرجات موثوقة.',
      e1: { title: 'محطة شاملة', text: 'توقيع وتمركز ورفع تفصيلي بدقة.' },
      e2: { title: 'GPS/GNSS RTK', text: 'دقة سنتيمترية في الزمن الحقيقي للمسافات الطويلة.' },
      e3: { title: 'الدرونات', text: 'صور مصححة عالية الدقة وأحجام وفحص سريع.' },
      e4: { title: 'البرمجيات', text: 'AutoCAD, Civil 3D, QGIS/ArcGIS, Pix4D, Revit, CloudCompare.' }
    },
    contact: {
      badge: 'اتصال',
      title: 'اطلب عرض سعر',
      desc: 'أرفق المخطط أو المساحة والموقع والموعد، أرد خلال 24 ساعة.',
      whatsapp: 'واتساب مباشر'
    },
    form: {
      name: 'الاسم / الشركة',
      email: 'البريد الإلكتروني',
      phone: 'هاتف / واتساب',
      project: 'نوع المشروع',
      details: 'تفاصيل / المساحة / الموعد'
    },
    footer: {
      text: 'طبوغرافيا دقيقة، مخرجات جاهزة، استجابة سريعة.',
      links: 'روابط',
      contact: 'اتصال'
    }
  }
};

const els = {
  html: document.documentElement,
  map: null
};

function applyTranslations(lang) {
  const dict = i18n[lang];
  if (!dict) return;

  document.querySelectorAll('[data-i18n]').forEach(el => {
    const keys = el.getAttribute('data-i18n').split('.');
    let value = dict;
    keys.forEach(k => { value = value?.[k]; });
    if (typeof value === 'string') el.textContent = value;
  });

  const dir = lang === 'ar' ? 'rtl' : 'ltr';
  els.html.setAttribute('dir', dir);
  els.html.setAttribute('lang', lang);
  document.body.style.direction = dir;

  document.querySelectorAll('.lang-switch button').forEach(btn => {
    btn.classList.toggle('active', btn.id === `lang-${lang}`);
  });
}

function initMap() {
  els.map = L.map('map', { zoomControl: false }).setView([48.8566, 2.3522], 12);
  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    maxZoom: 19,
    attribution: '© OpenStreetMap'
  }).addTo(els.map);
  L.marker([48.8566, 2.3522]).addTo(els.map).bindPopup('Exemple relevé drone + GNSS').openPopup();
}

function setupLangSwitch() {
  document.getElementById('lang-fr').addEventListener('click', () => applyTranslations('fr'));
  document.getElementById('lang-ar').addEventListener('click', () => applyTranslations('ar'));
}

document.addEventListener('DOMContentLoaded', () => {
  setupLangSwitch();
  applyTranslations('fr');
  initMap();
});


